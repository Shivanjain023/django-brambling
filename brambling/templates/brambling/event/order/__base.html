{% extends 'brambling/layouts/12.html' %}

{% load staticfiles %}

{% block title %}{{ event.name }} – {{ block.super }}{% endblock %}

{% block meta %}
	<meta name="description" content="{{ event.description }}" />
	<meta property="og:site_name" content="Dancerfly" />

	<meta property="og:title" content="{{ event.name }}" />
	<meta property="og:description" content="{{ event.description }}" />
	<meta property="og:url" content="https://{{ site.domain }}{% url 'brambling_event_order_summary' event_slug=event.slug %}" />
	{% if event.banner_image %}
		<meta property="og:image" content="{% if MEDIA_URL|slice:':7' != 'http://' and MEDIA_URL|slice:':8' != 'https://' %}https://{{ site.domain }}{% endif %}{{ MEDIA_URL }}{{ event.banner_image }}" />
		<meta property="og:image:width" content="{{ event.banner_image.width }}" />
		<meta property="og:image:height" content="{{ event.banner_image.height }}" />
	{% endif %}
{% endblock %}

{% block top %}
	{% if event.banner_image %}
		{{ block.super }}
	{% else %}
		{% include "brambling/_navbar.html" with navbar_class="navbar navbar-default navbar-fixed-top orange-barred navbar-hugged" %}
	{% endif %}
{% endblock %}

{% block messages %}{% endblock %}{# blank the messages here and put them lower down #}

{% block main %}
	{% block masthead %}
		{% include "brambling/event/order/_masthead.html" %}

		{% if workflow %}
			{% include "brambling/event/order/_steps.html" %}
		{% endif %}
	{% endblock masthead %}

	{% include "brambling/layouts/_messages.html" %}

	{% block countdown_next %}
		{% if order.has_cart %}
			{% if next_step %}
				<div class='row margin-trailer'>
					<div class='col-md-6'>
						{% include "brambling/event/order/_expiry_countdown.html" with expiry_time=order.cart_expire_time %}
					</div>
					<div class='col-md-6'>
						{% block next_step_button %}
							{% include "brambling/event/order/_next_step_button.html" %}
						{% endblock %}
					</div>
				</div>
			{% else %}
				{% include "brambling/event/order/_expiry_countdown.html" with expiry_time=order.cart_expire_time %}
			{% endif %}
		{% endif %}
	{% endblock countdown_next %}
{% endblock %}

{% block javascripts %}
	{# This bit of javascript needs to run pretty early to avoid a flash of content and jump. #}
	{% if event.banner_image and current_step.name != "Shop" %}
		<script type="text/javascript">
			(function () {
				var scroll_to = document.getElementById("mastheadDetails").getBoundingClientRect().top + window.pageYOffset - document.documentElement.clientTop - 10;
				// Scroll to where the mastheadDetails element should be.
				window.scrollTo(0, scroll_to);
			}());
		</script>
	{% endif %}

	{{ block.super }}
	<script type="text/javascript" src="{% static "zenaida/js/bootstrap/modal.js" %}"></script>
{% endblock %}
