{% extends 'brambling/event/order/__base.html' %}

{% load floppyforms %}

{% block title %}Survey â€“ {{ block.super }}{% endblock %}

{% block javascripts %}
	{{ block.super }}

	{% include 'brambling/event/order/_use_discount_js.html' %}

	<script>
		$(function(){
			$('#id_heard_through').on('change', function() {
				if (this.value=='other') {
					$('#heardOtherField').collapse('show');
				} else {
					$('#heardOtherField').collapse('hide');
				}
			});
			$('#heardOtherField').collapse({
				toggle: false
			});
			$('#id_heard_through').trigger('change');

			$('#id_send_flyers').on('change', function() {
				if (this.checked) {
					$('#promotionalCollapse').collapse('show');
				} else {
					$('#promotionalCollapse').collapse('hide');
				}
			});
			$('#promotionalCollapse').collapse({
				toggle: false
			});
			$('#id_send_flyers').trigger('change');
		});
	</script>
{% endblock %}

{% block next_step_button %}
	<button type="submit" class="btn btn-success btn-lg btn-block">Next step <span class='fa fa-chevron-right'></span></button>
{% endblock %}

{% block main %}
	<form action="" method="post" novalidate>
		{{ block.super }}

		{% csrf_token %}
		{% form form using %}
			{% formconfig row using "floppyforms/rows/bootstrap.html" %}

			{% formrow form.heard_through %}

			<div id="heardOtherField" class="collapse{% if form.instance.heard_through %} in{% endif %}">
				{% formrow form.heard_through_other %}
			</div>

				{% formrow form.send_flyers with label="I would love to distribute promotional materials for "|add:event.name|add:" to my community. Please mail me some!" %}
			<div id="promotionalCollapse" class="collapse{% if form.instance.send_flyers %} in{% endif %}">
				{% formrow form.send_flyers_address %}
				<div class="row">
					<div class="col-md-5">{% formrow form.send_flyers_city %}</div>
					<div class="col-md-3">{% formrow form.send_flyers_state_or_province %}</div>
					<div class="col-md-4">{% formrow form.send_flyers_country %}</div>
				</div>
			</div>
		{% endform %}
	</form>
{% endblock %}
