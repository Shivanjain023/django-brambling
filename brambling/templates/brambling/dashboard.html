{% extends "brambling/layouts/8_4.html" %}

{% load staticfiles hints %}

{% block title %}Your events – {{ block.super }}{% endblock %}

{% block main %}

	{% hint request.user "welcome" %}
		<div class="alert alert-info" id="welcomeHint">
			<form action="{{ hint.dismiss_action }}" method="post" data-dismiss-hint="#welcomeHint">

				{% csrf_token %}
				{{ hint.dismiss_form }}

				<button class="close"><span aria-hidden="true">&times;</span></button>

				<p><strong>Welcome to Dancerfly!</strong></p>

				<p>
					Thanks for signing up for Dancerfly.
					We&#8217;re happy to have you here! If you were registering
					for an event, head back to that event page. We&#8217;ll keep
					you logged in so you can register quickly.
				</p>
				<p>
					Below is a list of upcoming events we think you might be
					interested in. If there&#8217;s not much listed there it&#8217;s
					because there aren&#8217;t enough events coming up or because
					your dance preferences are too restrictive. You can update those
					preferences (and other settings) on your
					<a href="{% url "brambling_user_profile"%}" class="alert-link">profile settings</a>
					page.
				</p>
				<p>
					When you&#8217;re ready to use the website on your own, go ahead
					and dismiss this message with the <strong>&times;</strong> in the corner. We won&#8217;t
					show it again.
				</p>

			</form>
		</div>
	{% endhint %}

	{% if registered_events %}
		<div class="page-header">
			<h1>Events You Registered For</h1>
		</div>
		{% for event in registered_events %}
			{% include "brambling/_event_list_item.html" with registered="true" %}
		{% endfor %}
	{% endif %}

	<div class="page-header{% if registered_events %} margin-leader-dbl{% endif %}">
		<h1>Upcoming Events</h1>
	</div>
	{% if upcoming_events_interest %}
		{% for event in upcoming_events_interest|slice:"5" %}
			{% include "brambling/_event_list_item.html" %}
		{% endfor %}
	{% elif upcoming_events %}
		{% for event in upcoming_events|slice:"5" %}
			{% include "brambling/_event_list_item.html" %}
		{% endfor %}
	{% else %}
		<p>No upcoming events</p>
	{% endif %}
{% endblock %}

{% block side %}
	{% if admin_events %}
		<div class="panel panel-default">
			<header class="panel-heading">
				<h4 class="panel-title">Events You Manage</h4>
			</header>
			<div class="list-group">
				{% for event in admin_events %}
					{% include "brambling/_event_list-group-item.html" %}
				{% endfor %}
			</div>
		</div>
	{% endif %}
	{% if past_events %}
		<div class="panel panel-default">
			<header class="panel-heading">
				<h4 class="panel-title">Past Events You Registered For</h4>
			</header>
			<div class="list-group">
				{% for event in past_events %}
					{% include "brambling/_event_list-group-item.html" %}
				{% endfor %}
			</div>
		</div>
	{% endif %}
	{% with organizations=request.user.get_organizations %}
		{% if organizations %}
			<div class="panel panel-default">
				<div class="panel-heading">
					<h4 class="panel-title">Your Organizations</h4>
				</div>
				<div class="list-group">
					{% for organization in organizations %}
						<div class="list-group-item clearfix">
							<a class="pull-right btn btn-xs btn-default tipped" data-placement="left" data-container="body" title="Organization Settings" href="{% url 'brambling_organization_update' organization_slug=organization.slug %}">
								<i class="fa fa-fw fa-cog"></i>
								<span class="sr-only">Organization Settings</span>
							</a>
							<a href="{{ organization.get_absolute_url }}">{{ organization.name }}</a>
						</div>
					{% endfor %}
				</div>
			</div>
		{% endif %}
	{% endwith %}
{% endblock %}
