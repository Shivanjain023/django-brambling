{% load floppyforms %}
{% formconfig row using "floppyforms/rows/bootstrap.html" %}

<div class="panel panel-default">
	<header class="panel-heading">
		<h4 class="panel-title">Information</h4>
	</header>
	<div class="panel-body">
		{% formrow form.name %}
		{% formrow form.slug %}
		{% formrow form.tagline %}
		{% formrow form.dance_styles %}
		{% formrow form.has_dances %}
		{% formrow form.has_classes %}
	</div>{# /.panel-body #}
</div>{# /.panel #}

<div class="panel panel-default">
	<header class="panel-heading">
		<h4 class="panel-title">Details</h4>
	</header>
	<div class="panel-body">
		{% formrow form.start_date %}
		{% formrow form.end_date %}

		<div class="row">
			<div class="col-sm-5">
				{% formrow form.city %}
			</div>
			<div class="col-sm-3">
				{% formrow form.state_or_province %}
			</div>
			<div class="col-sm-4">
				{% formrow form.country %}
			</div>
		</div>{# /.row #}

		{% formrow form.timezone %}

		<small><a href="https://support.stripe.com/questions/which-currencies-does-stripe-support" class="pull-right">Supported Currencies</a></small>
		{% formrow form.currency %}

		{% include "brambling/_stripe_note.html" %}
	</div>{# /.panel-body #}
</div>{# /.panel #}

<div class="panel panel-default">
	<header class="panel-heading">
		<h4 class="panel-title">Settings</h4>
	</header>
	<div class="panel-body">
		{% formrow form.cart_timeout %}
		<div class='form-group'>
			{% with field=form.collect_housing_data %}
				<div class='checkbox'>
					<label for="{{ field|id }}">{% formfield field %} {{ field.label }}</label>
				</div>
			{% endwith %}
			{% with field=form.collect_survey_data %}
				<div class='checkbox'>
					<label for="{{ field|id }}">{% formfield field %} {{ field.label }}</label> <a class="popped" data-container="body" data-toggle="popover" data-placement="top" data-title="Survey Contents" data-content="Where did they hear about the event; would they like promotional materials to distribute; are they providing housing?"><i class="fa fa-question-circle"></i></a>
				</div>
			{% endwith %}
		</div>
		{% formrow form.liability_waiver %}
		{% formrow form.privacy %}
		{% formrow form.editors %}
	</div>{# /.panel-body #}
</div>{# /.panel #}

{% if form.instance.pk %}
	<div class='panel panel-default'>
		<header class="panel-heading">
			<h4 class="panel-title">Payment Options</h4>
		</header>
		<div class='panel-body'>
			{% if form.STRIPE_APPLICATION_ID %}
				<h3>Stripe</h3>

				{% if form.instance.uses_stripe %}
					<p>Connected account: {{ form.instance.stripe_user_id }}</p>
					{% formrow form.disconnect_stripe with label="Disconnect" %}
				{% else %}
					<a href='https://connect.stripe.com/oauth/authorize?client_id={{ form.STRIPE_APPLICATION_ID }}&response_type=code&scope=read_write&state={{ form.instance.slug }}' class='btn btn-primary'>Connect to Stripe <i class='fa fa-external-link'></i></a>
				{% endif %}

				<hr />
			{% endif %}

			<h3>Dwolla</h3>
			{% formrow form.dwolla_recipient %}
		</div>
	</div>
{% endif %}
